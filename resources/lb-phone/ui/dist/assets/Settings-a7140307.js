import{u as p,r as S,j as i,m as k,S as O,a as e,I as L,L as s,P as d,J as W,au as ae,av as w,aw as ne,ax as le,ay as ce,az as ee,F as g,C as f,b as D,aA as re,aB as se,x as U,ai as B,aC as oe,aD as ie,t as x,aE as te,aj as de,aF as Se,aG as Pe,aH as Ne,aI as J,aJ as Z,p as I,M as me,q as F,y as j,f as z,aK as Te,o as he,s as K,aL as ue,aM as pe,aN as Ee,l as ve,aO as ge,aP as Ae,aQ as Ie,aR as Ce,aS as fe,aT as Ge,w as ke,g as Oe,d as _e,A as ye}from"./index-2acb14b9.js";import{S as Y}from"./Slider-4e8c53b1.js";function be(r){const l=p(d.Settings),c=p(D),a=p(re),[N,n]=S.useState(!1),m=["#39334d","#465281","#87855e","#4b6a45","#702e2e","picker"];return i(k.div,{...O("right","display"),className:"animation-container display",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>N?n(!1):r.setPage([]),children:[e(L,{}),s("APPS.SETTINGS.TITLE")]}),e("div",{className:"title",children:s("APPS.SETTINGS.DISPLAY_BRIGHTNESS")}),e("div",{})]}),e("div",{style:{marginTop:"2rem"}}),e("div",{className:"category-title",children:s("APPS.SETTINGS.APPEARANCE")}),i("section",{children:[e("div",{className:"settings-item",children:e("div",{className:"appearance-container",children:e("div",{className:"appearance-switches",children:["light","dark"].map((o,T)=>{var h;return i("div",{className:"mode",onClick:()=>{d.Settings.patch({display:{...l.display,theme:o}})},children:[e("img",{src:`./assets/img/${o}-mode-placeholder.webp`,alt:"Theme"}),e("div",{className:"mode-text",children:W(o)}),e(ae,{checked:((h=l==null?void 0:l.display)==null?void 0:h.theme)===o})]},T)})})})}),i("div",{className:"settings-item",children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.AUTOMATIC")})}),e("div",{className:"setting-value",children:e(w,{checked:l.display.automatic,onChange:()=>{d.Settings.patch({display:{...l.display,automatic:!l.display.automatic}})}})})]})]}),e("div",{className:"category-title",children:s("APPS.SETTINGS.BRIGHTNESS")}),e("section",{children:i("div",{className:"settings-item",children:[e(ne,{}),e(Y,{onChange:o=>{d.Settings.patch({display:{...l.display,brightness:o}})},value:l.display.brightness,id:"brightness",min:.1,max:1,step:.01}),e(le,{})]})}),e("div",{className:"category-title",children:s("APPS.SETTINGS.PHONE_SCALE")}),e("section",{children:i("div",{className:"settings-item",children:[e(ce,{}),e(Y,{onChange:o=>{a||d.Settings.patch({display:{...l.display,size:o}})},value:l.display.size,id:"phone-scale-slider",min:.5,max:1.1,step:.1}),e(ee,{})]})}),c.allowFrameColorChange&&i(g,{children:[e("div",{className:"category-title",children:s("APPS.SETTINGS.FRAME_COLOR")}),e("section",{children:e("div",{className:"settings-item",children:e("div",{className:"colors",children:m.map((o,T)=>{let h=o==="picker";return e("div",{className:"color",style:{backgroundImage:h&&"url(./assets/img/icons/picker.png)",boxShadow:!h&&`inset  0 0.1em 5em ${o}, 0 0 0 0.2em hsl(254, 30%, 85%)`},"data-active":l.display.frameColor===o,onClick:()=>{if(h){f.ColorPicker.set({onSelect:E=>{d.Settings.patch({display:{...l.display,frameColor:E}})}});return}d.Settings.patch({display:{...l.display,frameColor:o}})}},T)})})})})]})]})}function Le(r){var o,T,h,E;const l=p(D),c=p(d.Settings),[a,N]=S.useState(!1),[n,m]=S.useState(null);return i(k.div,{...O("right",a?"notificationsInApp":"notifications"),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>{a?N(!1):r.setPage([])},children:[e(L,{}),a?s("APPS.SETTINGS.BACK"):s("APPS.SETTINGS.TITLE")]}),e("div",{className:"title",children:a?s(`APP_NAMES.${n}`,l.apps[n].name):s("APPS.SETTINGS.NOTIFICATIONS")}),e("div",{})]}),e("div",{style:{marginTop:"0.5rem"}}),a?e(g,{children:i("section",{children:[i("div",{className:"settings-item",children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.ALLOW_NOTIFICATIONS")})}),e("div",{className:"setting-value",children:e(w,{onChange:()=>{var P,u,_;d.Settings.patch({notifications:{...c.notifications,[n]:{...(P=c.notifications)==null?void 0:P[n],enabled:!((_=(u=c.notifications)==null?void 0:u[n])!=null&&_.enabled)}}})},checked:((T=(o=c.notifications)==null?void 0:o[n])==null?void 0:T.enabled)??!0})})]}),i("div",{className:"settings-item",children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.SOUNDS")})}),e("div",{className:"setting-value",children:e(w,{onChange:()=>{var P,u,_;d.Settings.patch({notifications:{...c.notifications,[n]:{...(P=c.notifications)==null?void 0:P[n],sound:!((_=(u=c.notifications)==null?void 0:u[n])!=null&&_.sound)}}})},checked:((E=(h=c.notifications)==null?void 0:h[n])==null?void 0:E.sound)??!0})})]})]})}):i(g,{children:[e("div",{className:"category-title",children:s("APPS.SETTINGS.NOTIFICATIONS")}),e("section",{style:{marginBottom:"4rem"},children:Object.keys(l.apps).filter(P=>{var u;return se(P)||((u=l.apps[P])==null?void 0:u.removable)===!1}).sort((P,u)=>s(`APP_NAMES.${P}`,l.apps[P].name).localeCompare(s(`APP_NAMES.${u}`,l.apps[u].name))).map((P,u)=>i("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>{m(P),N(!0)},children:[i("div",{className:"setting",children:[e("img",{src:l.apps[P].icon??`./assets/img/icons/apps/${P}.jpg`}),e("div",{className:"title",children:s(`APP_NAMES.${P}`,l.apps[P].name)})]}),e("div",{className:"setting-value",children:e(U,{className:"chevron"})})]},u))})]})]})}function Ue(r){var o;const l=p(d.Settings),[c,a]=S.useState(!1),[N,n]=S.useState(null),m=p(D);return i(k.div,{...O("right",c?"soundBrowsingTunes":"sound"),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>{c?a(!1):r.setPage([]),d.SoundManager.reset()},children:[e(L,{}),c?s("APPS.SETTINGS.BACK"):s("APPS.SETTINGS.TITLE")]}),e("div",{className:"title",children:c?N==="ringtone"?s("APPS.SETTINGS.RINGTONE"):s("APPS.SETTINGS.TEXT_TONE"):s("APPS.SETTINGS.SOUND_HAPTICS")}),e("div",{})]}),e("div",{style:{marginTop:"0.5rem"}}),c?i(g,{children:[e("div",{className:"category-title",children:N==="ringtone"?s("APPS.SETTINGS.RINGTONE"):s("APPS.SETTINGS.TEXT_TONE")}),e("section",{children:Object.keys((o=m.sounds)==null?void 0:o[N]).map((T,h)=>e("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>{var E,P;d.Settings.patch({sound:{...d.Settings.value.sound,[N]:T}}),d.SoundManager.set({url:`./assets/sound/ringtones/${(P=(E=m.sounds)==null?void 0:E[N])==null?void 0:P[T]}`,timeout:N==="ringtones"?5e3:null,override:!0})},children:i("div",{className:"setting",children:[T==l.sound[N]?e(B,{className:"checkmark"}):e(B,{className:"checkmark hidden"}),e("div",{className:"title",children:W(T)})]})},h))})]}):i(g,{children:[e("div",{className:"category-title",children:s("APPS.SETTINGS.RINGTONE_VOLUME")}),e("section",{children:i("div",{className:"settings-item",children:[e(oe,{}),e(Y,{onChange:T=>{d.Settings.patch({sound:{...d.Settings.value.sound,volume:T}})},value:l.sound.volume,min:0,max:1,step:.05}),e(ie,{})]})}),e("div",{className:"category-title",children:s("APPS.SETTINGS.SOUND_HAPTICS_PATTERNS")}),i("section",{children:[i("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>{n("ringtone"),a(!0)},children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.RINGTONE")})}),i("div",{className:"setting-value",children:[e("div",{className:"value",children:W(l.sound.ringtone)}),e(U,{className:"chevron"})]})]}),i("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>{n("texttone"),a(!0)},children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.TEXT_TONE")})}),i("div",{className:"setting-value",children:[e("div",{className:"value",children:W(l.sound.texttone)}),e(U,{className:"chevron"})]})]})]})]})]})}function Re(r){const{settingsSections:l}=S.useContext($),c=p(d.Settings),a=p(D),N=8.25*1e3*1e3;return S.useEffect(()=>{if(!a.apps)return;let n=Object.keys(a.apps).filter(o=>{var T;return((T=a.apps[o])==null?void 0:T.removable)===!1}).reduce((o,T)=>o+a.apps[T].size,0),m=c.storage.used-(n+N);D.patch({apps:{...a.apps,Photos:{...a.apps.Photos,size:a.apps.Photos.size+m}}})},[]),i(k.div,{...O("right","storage"),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>{var n;r.setPage((n=l==null?void 0:l[2])==null?void 0:n[0].options)},children:[e(L,{}),s("APPS.SETTINGS.TITLE")]}),e("div",{className:"title",children:s("APPS.SETTINGS.STORAGE")}),e("div",{})]}),e("div",{style:{marginTop:"0.5rem"}}),e("section",{children:i("div",{className:"settings-item",style:{cursor:"pointer"},children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.USED")})}),e("div",{className:"setting-value",children:i("div",{className:"value",children:[x(c.storage.used/1e3/1e3,2)," GB ",s("APPS.SETTINGS.OF")," ",x(c.storage.total/1e3/1e3,0)," GB"]})})]})}),e("section",{children:Object.keys(a.apps).filter(n=>{var m;return se(n)||((m=a.apps[n])==null?void 0:m.removable)===!1}).sort((n,m)=>a.apps[m].size-a.apps[n].size).map((n,m)=>i("div",{className:"settings-item",style:{cursor:"pointer"},children:[i("div",{className:"setting",children:[e("img",{src:a.apps[n].icon??`./assets/img/icons/apps/${n}.jpg`}),e("div",{className:"title",children:s(`APP_NAMES.${n}`,a.apps[n].name)})]}),e("div",{className:"setting-value",children:e("div",{className:"value",children:a.apps[n].size>1e6?x(a.apps[n].size/1e6,2)+" GB":a.apps[n].size>1e3?x(a.apps[n].size/1e3,2)+" MB":a.apps[n].size+" KB"})})]}))})]})}function Be(r){const l=p(d.Settings),[c,a]=S.useState(!1),N=p(D);return i(k.div,{...O("right",c?"browsingWallpapers":"wallpaper"),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>{c?a(!1):r.setPage([])},children:[e(L,{}),c?s("APPS.SETTINGS.WALLPAPER"):s("APPS.SETTINGS.TITLE")]}),i("div",{className:"title",children:[c?s("APPS.SETTINGS.WALLPAPERS"):s("APPS.SETTINGS.WALLPAPER")," "]}),e("div",{})]}),c?i("div",{className:"wallpapers-container",children:[e("div",{className:"wallpaper add",onClick:()=>{var n,m,o;f.Gallery.set({allowExternal:(o=(m=(n=D)==null?void 0:n.value)==null?void 0:m.AllowExternal)==null?void 0:o.Other,onSelect:T=>{d.Settings.patch({wallpaper:{...l.wallpaper,background:T.src}})}})},children:e(ee,{})}),l.wallpaper.background.includes("http")&&e("div",{className:"wallpaper active",style:{backgroundImage:`url(${l.wallpaper.background})`}}),Object.keys(N.wallpapers).map((n,m)=>e(we,{wallpaper:n,selected:l.wallpaper.background,theme:l.display.theme,cb:()=>{d.Settings.patch({wallpaper:{...l.wallpaper,background:n}})}},m))]}):e(De,{setExploringWallpapers:a})]})}const we=({wallpaper:r,selected:l,cb:c})=>{const[a,N]=S.useState("");return S.useEffect(()=>{te(r,n=>N(n))},[]),e("div",{className:de("wallpaper",l===r&&"active"),style:{backgroundImage:`url(${a})`},onClick:()=>c()})},De=r=>{var N;const[l,c]=S.useState(""),a=p(d.Settings);return S.useEffect(()=>{te(a.wallpaper.background,n=>c(n))},[]),i("section",{children:[i("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>r.setExploringWallpapers(!0),children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.CHOOSE_NEW_WALLPAPER")})}),e("div",{className:"setting-value",children:e(U,{className:"chevron"})})]}),e("div",{className:"settings-item",children:i("div",{className:"wallpapers",children:[e("div",{className:"preview",style:{backgroundImage:`url(${l})`},children:i("div",{className:"lockscreen-container",children:[e(Se,{}),e(Pe,{layout:((N=a.lockscreen)==null?void 0:N.layout)??1})]})}),e("div",{className:"preview",style:{backgroundImage:`url(${l})`},children:i("div",{className:"settings-homescreen-container",children:[e("div",{className:"settings-homescreen-apps",children:a.apps[1].filter(n=>!Ne(n)).slice(0,24).map(n=>{var T;let m=D.value.apps[n],o=((T=m==null?void 0:m[n])==null?void 0:T.icon)??`./assets/img/icons/apps/${n}.jpg`;return i("div",{className:"settings-homescreen-app",children:[e("img",{src:o,onError:h=>h.currentTarget.src="./assets/img/icons/apps/unkown.png"}),e("div",{className:"app-name",children:n})]})})}),e("div",{className:"favourite-apps",children:a.apps[0].map(n=>e("div",{className:"settings-homescreen-app",children:e("img",{src:`./assets/img/icons/apps/${n}.jpg`})}))})]})})]})}),i("div",{className:"settings-item",children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.BLUR_HOMESCREEN")})}),e("div",{className:"setting-value",children:e(w,{checked:a.wallpaper.blur,onChange:()=>{d.Settings.patch({wallpaper:{...a.wallpaper,blur:!a.wallpaper.blur}})}})})]})]})};function Me(r){const l=S.useRef(null),c=p(d.Settings),[a,N]=S.useState([]),[n,m]=S.useState(!1),[o,T]=S.useState([]),[h,E]=S.useState(!1),P=v=>{if(v=="backspace")N(G=>G.slice(0,-1));else{const G=[...a,v];N([...a,v]),G.length>3&&(h?I("Security",{action:"setPin",pin:G.join("")}).then(H=>{d.Settings.patch({security:{...c.security,pinCode:!0}}),E(!1),N([])}):I("Security",{action:"verifyPin",pin:G.join("")}).then(H=>{H?(m(!0),T(G),N([])):(l.current.className=`pin-circles wrong ${c.display.theme=="dark"?"light":"dark"}`,setTimeout(()=>{l.current.className=`pin-circles ${c.display.theme=="dark"?"light":"dark"}`,N([])},350))}))}},u=v=>{v?I("Security",{action:"setFaceId",pin:o.join("")}).then(G=>{G&&d.Settings.patch({security:{...d.Settings.value.security,faceId:!0}})}):I("Security",{action:"removeFaceId",pin:o.join("")}).then(G=>{G&&d.Settings.patch({security:{...d.Settings.value.security,faceId:!1}})})},_=()=>{I("Security",{action:"removePin",pin:a.join("")}).then(v=>{v&&d.Settings.patch({security:{pinCode:!1,faceId:!1}})})};return i(k.div,{...O("right","passcode"),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>{r.setPage([])},children:[e("i",{className:"fal fa-chevron-left"}),n||!c.security.pinCode?s("APPS.SETTINGS.BACK"):s("CANCEL")]}),e("div",{className:"title",children:n||!c.security.pinCode?s("APPS.SETTINGS.FACE_ID_PASSWORD"):s("APPS.SETTINGS.ENTER_PASSCODE")}),e("div",{})]}),n||!c.security.pinCode?e(g,{children:h?i("div",{className:"passcode-container",children:[i("div",{className:"pin",children:[s("APPS.SETTINGS.ENTER_PASSCODE"),e(J,{pin:a,dark:c.display.theme==="light",Ref:l})]}),e("div",{className:"numbers",children:e(Z,{cb:v=>{P(v)}})})]}):i(g,{children:[e("div",{style:{marginTop:"0.5rem"}}),e("div",{className:"category-title",children:s("APPS.SETTINGS.FACE_ID")}),e("section",{children:c.security.faceId?e("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>{f.PopUp.set({title:s("APPS.SETTINGS.DISABLE_FACE_ID_POPUP.TITLE"),description:s("APPS.SETTINGS.DISABLE_FACE_ID_POPUP.TEXT"),buttons:[{title:s("APPS.SETTINGS.DISABLE_FACE_ID_POPUP.CANCEL")},{title:s("APPS.SETTINGS.DISABLE_FACE_ID_POPUP.CONFIRM"),color:"red",cb:()=>{u(!1)}}]})},children:e("div",{className:"setting",children:e("div",{className:"title red",children:s("APPS.SETTINGS.RESET_FACE_ID")})})}):e("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>{c.security.pinCode&&f.PopUp.set({title:s("APPS.SETTINGS.ENABLE_FACE_ID_POPUP.TITLE"),description:s("APPS.SETTINGS.ENABLE_FACE_ID_POPUP.TEXT"),buttons:[{title:s("APPS.SETTINGS.ENABLE_FACE_ID_POPUP.CANCEL")},{title:s("APPS.SETTINGS.ENABLE_FACE_ID_POPUP.CONFIRM"),cb:()=>{u(!0)}}]})},children:e("div",{className:"setting",children:e("div",{className:`title ${c.security.pinCode?"blue":"grey"}`,children:s("APPS.SETTINGS.ENABLE_FACE_ID")})})})}),e("div",{className:"category-title",children:s("APPS.SETTINGS.PIN_CODE")}),e("section",{children:c.security.pinCode?i(g,{children:[e("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>{f.PopUp.set({title:s("APPS.SETTINGS.DISABLE_PIN_POPUP.TITLE"),description:s("APPS.SETTINGS.DISABLE_PIN_POPUP.TEXT"),buttons:[{title:s("APPS.SETTINGS.DISABLE_PIN_POPUP.CANCEL")},{title:s("APPS.SETTINGS.DISABLE_PIN_POPUP.CONFIRM"),color:"red",cb:()=>_()}]})},children:e("div",{className:"setting",children:e("div",{className:"title blue",children:s("APPS.SETTINGS.TURN_PASSCODE_OFF")})})}),e("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>E(!0),children:e("div",{className:"setting",children:e("div",{className:"title blue",children:s("APPS.SETTINGS.CHANGE_PASSCODE")})})})]}):i(g,{children:[e("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>{E(!0)},children:e("div",{className:"setting",children:e("div",{className:"title blue",children:s("APPS.SETTINGS.TURN_PASSCODE_ON")})})}),e("div",{className:"settings-item",children:e("div",{className:"setting",children:e("div",{className:"title grey",children:s("APPS.SETTINGS.CHANGE_PASSCODE")})})})]})})]})}):i("div",{className:"passcode-container",children:[i("div",{className:"pin",children:[s("APPS.SETTINGS.ENTER_PASSCODE"),e(J,{pin:a,dark:c.display.theme==="light",Ref:l})]}),e("div",{className:"numbers",children:e(Z,{cb:v=>P(v)})})]})]})}function Fe(r){var E;const l=p(d.Settings),c=p(d.PhoneNumber),[a,N]=S.useState(!1),[n,m]=S.useState(!1),[o,T]=S.useState([]);S.useEffect(()=>{I("Phone",{action:"getBlockedNumbers"},me.Blocked).then(P=>{if(!P)return F("warning","Failed to get blocked numbers, no response");T(P)})},[]);const h=P=>{I("Phone",{action:"toggleBlock",number:P,blocked:!1},!0).then(u=>{if(!u)return F("warning","Failed to unblock number",P);T(_=>_.filter(v=>v!==P))})};return i(k.div,{...O("right",a?"blocked":"phone"),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>a?N(!1):r.setPage([]),children:[e(L,{}),a?s("APPS.SETTINGS.BACK"):s("APPS.SETTINGS.TITLE")]}),e("div",{className:"title",children:a?s("APPS.SETTINGS.BLOCKED_CONTACTS"):s("APPS.SETTINGS.PHONE")}),a?e("div",{className:"value",onClick:()=>m(P=>!P),children:n?s("APPS.SETTINGS.DONE"):s("APPS.SETTINGS.EDIT")}):e("div",{})]}),e("div",{style:{marginTop:"0.5rem"}}),a?e(g,{children:e("section",{children:o.map((P,u)=>i("div",{className:"settings-item",children:[i("div",{className:"setting",children:[n?e(j,{className:"remove",onClick:()=>{f.PopUp.set({title:s("APPS.SETTINGS.UNBLOCK_POPUP.TITLE"),description:s("APPS.SETTINGS.UNBLOCK_POPUP.TEXT"),buttons:[{title:s("APPS.SETTINGS.UNBLOCK_POPUP.CANCEL")},{title:s("APPS.SETTINGS.UNBLOCK_POPUP.CONFIRM"),color:"red",cb:()=>{h(P)}}]})}}):e(j,{className:"hidden"}),e("div",{className:"title",children:z(P)})]}),e("div",{className:"setting-value"})]},u))})}):i(g,{children:[e("section",{children:i("div",{className:"settings-item",children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.MY_NUMBER")})}),i("div",{className:"setting-value",children:[z(c),e(Te,{onClick:()=>he(c)})]})]})}),i("section",{children:[i("div",{className:"settings-item",children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.SHOW_CALLER_ID")})}),e("div",{className:"setting-value",children:e(w,{onChange:()=>{var P;d.Settings.patch({phone:{...l.phone,showCallerId:!((P=l.phone)!=null&&P.showCallerId)}})},checked:((E=l.phone)==null?void 0:E.showCallerId)??!1})})]}),i("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>N(!0),children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.BLOCKED_CONTACTS")})}),e("div",{className:"setting-value",children:e(U,{className:"chevron"})})]})]})]})]})}function Ke({setPage:r}){const l=p(d.PhoneNumber),c=p(K.MISC.BACKUPS),[a,N]=S.useState(!1);return S.useEffect(()=>{c||I("Backup",{action:"get"},[{number:l},{number:"13144122"}]).then(n=>{if(!n)return F("warning","Failed to get backups from the server");K.MISC.BACKUPS.set(n)})},[]),i(k.div,{...O("right","profile"),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>r([]),children:[e(L,{}),s("APPS.SETTINGS.TITLE")]}),e("div",{className:"title",children:s("APPS.SETTINGS.CLOUD_BACKUP")}),e("div",{className:"value",onClick:()=>N(n=>!n),children:a?s("APPS.SETTINGS.DONE"):s("APPS.SETTINGS.EDIT")})]}),e("div",{style:{marginTop:"0.5rem"}}),e("div",{className:"category-title",children:s("APPS.SETTINGS.YOUR_PROFILE")}),e("section",{children:i("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>{if(c!=null&&c.find(n=>n.number===l))return f.PopUp.set({title:"Warning",description:"You already have a backup for this number",buttons:[{title:"OK"}]});f.PopUp.set({title:s("APPS.SETTINGS.SAVE_BACKUP_POPUP.TITLE"),description:s("APPS.SETTINGS.SAVE_BACKUP_POPUP.TEXT"),buttons:[{title:s("APPS.SETTINGS.SAVE_BACKUP_POPUP.CANCEL")},{title:s("APPS.SETTINGS.SAVE_BACKUP_POPUP.CONFIRM"),cb:()=>{I("Backup",{action:"create"},!0).then(n=>{if(!n)return F("warning","Failed to create a backup");K.MISC.BACKUPS.set([{number:l},...c])})}}]})},children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.CREATE_BACKUP")})}),e("div",{className:"setting-value"})]})}),e("div",{className:"category-title",children:s("APPS.SETTINGS.BACKUPS")}),e("section",{children:c==null?void 0:c.map((n,m)=>i("div",{className:"settings-item",style:{cursor:n.number!==l?"pointer":"not-allowed"},"data-disabled":n.number===l&&!a,onClick:()=>{if(n.number===l)return f.PopUp.set({title:"Error",description:"You cannot apply a backup created from the same phone",buttons:[{title:"OK"}]});f.PopUp.set({title:s("APPS.SETTINGS.APPLY_BACKUP_POPUP.TITLE"),description:s("APPS.SETTINGS.APPLY_BACKUP_POPUP.TEXT"),buttons:[{title:s("APPS.SETTINGS.APPLY_BACKUP_POPUP.CANCEL")},{title:s("APPS.SETTINGS.APPLY_BACKUP_POPUP.CONFIRM"),color:"red",cb:()=>{I("Backup",{action:"apply",number:n.number},!0).then(o=>{if(!o)return F("error","Could not apply backup, apply returned false");setTimeout(()=>{f.PopUp.set({title:s("APPS.SETTINGS.SUCCESS"),description:s("APPS.SETTINGS.SUCCESS_TEXT"),buttons:[{title:s("APPS.SETTINGS.OK")}]})},500)})}}]})},children:[i("div",{className:"setting",children:[a&&e(j,{className:"remove",onClick:o=>{o.stopPropagation(),f.PopUp.set({title:s("APPS.SETTINGS.REMOVE_BACKUP_POPUP.TITLE"),description:s("APPS.SETTINGS.REMOVE_BACKUP_POPUP.TEXT"),buttons:[{title:s("APPS.SETTINGS.REMOVE_BACKUP_POPUP.CANCEL")},{title:s("APPS.SETTINGS.REMOVE_BACKUP_POPUP.CONFIRM"),color:"red",cb:()=>{I("Backup",{action:"delete",number:n.number}).then(T=>{if(!T)return F("error","Could not delete backup");K.MISC.BACKUPS.set(K.MISC.BACKUPS.value.filter(h=>h.number!==n.number))})}}]})}}),e("div",{className:"title",children:z(n.number)})]}),e("div",{className:"setting-value"})]},m))})]})}function V(r,l){if(!r.match(/\d+\.\d+\.\d+/)||!l.match(/\d+\.\d+\.\d+/))return!1;const c=r.split(".").map(Number),a=l.split(".").map(Number);return(c[0]??0)<(a[0]??0)?!0:(c[0]??0)>(a[0]??0)?!1:(c[1]??0)<(a[1]??0)?!0:(c[1]??0)>(a[1]??0)?!1:(c[2]??0)<(a[2]??0)}function xe(r){const{settingsSections:l}=S.useContext($),c=p(d.Settings);return i(k.div,{...O("right","softwareUpdate"),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>{var a;return r.setPage((a=l==null?void 0:l[2])==null?void 0:a[0].options)},children:[e(L,{}),s("APPS.SETTINGS.TITLE")]}),e("div",{className:"title",children:s("APPS.SETTINGS.SOFTWARE_UPDATE")}),e("div",{})]}),e("div",{style:{marginTop:"0.5rem"}}),e("section",{children:i("div",{className:"settings-item",style:{cursor:"pointer"},children:[e("div",{className:"setting",children:e("div",{className:"title",children:s("APPS.SETTINGS.AUTOMATIC_UPDATES")})}),e("div",{className:"setting-value",children:e("div",{className:"value",children:s("APPS.SETTINGS.OFF")})})]})}),V(c.version,c.latestVersion)&&e("section",{children:i("div",{className:"settings-item",style:{flexDirection:"column",alignItems:"inherit",gap:"0.75rem"},children:[i("div",{className:"item-header",children:[e("img",{src:"./assets/img/lbos.webp"}),i("div",{className:"info",children:[e("div",{className:"title",children:c.latestVersion}),e("div",{className:"author",children:e(He,{})})]})]}),e("div",{className:"item-content",children:"Please tell your server owner to update the phone to the latest version."})]})}),!V(c.version,c.latestVersion)&&i("div",{className:"up-to-date",children:[i("div",{className:"version",children:["V ",c==null?void 0:c.version]}),e("div",{className:"title",children:s("APPS.SETTINGS.UP_TO_DATE")})]})]})}const He=()=>{const r="abcdefghijklmnopqrstuvwxyz".split("");return i(g,{children:[r[11].toUpperCase(),r[1].toUpperCase()]})};function Q({setPage:r,type:l}){const{settingsSections:c}=S.useContext($);return i(k.div,{...O("right",l??"system"),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>{var a;return r((a=c==null?void 0:c[2])==null?void 0:a[0].options[1][1].options)},children:[e(L,{}),s("APPS.SETTINGS.TITLE")]}),e("div",{className:"title",children:s(`APPS.SETTINGS.${l.toUpperCase()}`)}),e("div",{})]}),e("div",{style:{marginTop:"0.5rem"}}),i("section",{children:[l==="Language"&&e(We,{}),l==="Temperature"&&e(Ve,{})]})]})}const We=()=>{const r=p(d.Settings),[l,c]=S.useState([]);return S.useEffect(()=>{I("getLocales",null,ue).then(a=>{a&&c(a)})},[]),S.useEffect(()=>{pe(r.locale)},[r.locale]),i(g,{children:[l.map((a,N)=>e("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>d.Settings.patch({locale:a.locale}),children:i("div",{className:"setting",children:[a.locale===r.locale?e(B,{className:"checkmark"}):e(B,{className:"checkmark hidden"}),e("div",{className:"title",children:a.name})]})},N)),";"]})},Ve=()=>{const r=p(d.Settings);return i(g,{children:[e("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>d.Settings.patch({weather:{celcius:!0}}),children:i("div",{className:"setting",children:[r.weather&&r.weather.celcius?e(B,{className:"checkmark"}):e(B,{className:"checkmark hidden"}),e("div",{className:"title",children:s("APPS.SETTINGS.CELCIUS")})]})}),e("div",{className:"settings-item",style:{cursor:"pointer"},onClick:()=>d.Settings.patch({weather:{celcius:!1}}),children:i("div",{className:"setting",children:[r.weather&&r.weather.celcius===!1?e(B,{className:"checkmark"}):e(B,{className:"checkmark hidden"}),e("div",{className:"title",children:s("APPS.SETTINGS.FAHRENHEIT")})]})})]})};const $=S.createContext(null);function ze(){var q;const r=p(d.Settings),[l,c]=S.useState(""),[a,N]=S.useState([]),n=p(ye),[m,o]=S.useState([]),[T,h]=S.useState(null),[E,P]=S.useState(null),[u,_]=S.useState(null),[v,G]=S.useState([]);S.useEffect(()=>{G(C=>[[{name:s("APPS.SETTINGS.AIRPLANE_MODE"),icon:e(Ee,{className:"orange"}),description:s("APPS.SETTINGS.AIRPLANE_MODE_DESCRIPTION"),switch:!0,value:r.airplaneMode,onChange:()=>d.Settings.patch({airplaneMode:!r.airplaneMode})},{name:s("APPS.SETTINGS.STREAMER_MODE"),icon:e(ve,{className:"purple"}),description:s("APPS.SETTINGS.STREAMER_MODE_DESCRIPTION"),switch:!0,value:r.streamerMode,onChange:()=>d.Settings.patch({streamerMode:!r.streamerMode})}],[{name:s("APPS.SETTINGS.NOTIFICATIONS"),description:s("APPS.SETTINGS.NOTIFICATIONS_DESCRIPTION"),icon:e(ge,{className:"red"}),options:e(Le,{setPage:o})},{name:s("APPS.SETTINGS.SOUND_HAPTICS"),description:s("APPS.SETTINGS.SOUND_HAPTICS_DESCRIPTION"),icon:e(ie,{className:"pink"}),options:e(Ue,{setPage:o})}],[{name:s("APPS.SETTINGS.GENERAL"),description:s("APPS.SETTINGS.GENERAL_DESCRIPTION"),icon:e(Ae,{className:"grey"}),notification:V(r.version,r.latestVersion),options:[[{name:s("APPS.SETTINGS.ABOUT"),options:[[{name:s("APPS.SETTINGS.NAME"),value:r.name,input:{type:"name",maxLength:20},cb:(A,t)=>{I("setPhoneName",A)}},{name:s("APPS.SETTINGS.VERSION"),value:r.version},{name:s("APPS.SETTINGS.MODEL_NAME"),value:"LB Phone"},{name:s("APPS.SETTINGS.SERIAL_NUMBER"),value:"DSDWWWSSF3"},{name:s("APPS.SETTINGS.DEVELOPED_BY"),value:"Breze & Loaf Scripts"},{name:s("APPS.SETTINGS.PURCHASE_AT"),value:"https://store.lbscripts.com",isLink:!0}],[{name:s("APPS.SETTINGS.SONGS"),value:"0"},{name:s("APPS.SETTINGS.VIDEOS"),value:0},{name:s("APPS.SETTINGS.PHOTOS"),value:0},{name:s("APPS.SETTINGS.APPLICATIONS"),value:H()},{name:s("APPS.SETTINGS.CAPACITY"),value:`${r.storage.total/1e3/1e3} GB`},{name:s("APPS.SETTINGS.AVAILABLE"),value:`${x((r.storage.total-r.storage.used)/1e3/1e3,1)} GB`}]]},{name:s("APPS.SETTINGS.SOFTWARE_UPDATE"),options:e(xe,{setPage:o}),notification:V(r.version,r.latestVersion)},{name:s("APPS.SETTINGS.PHONE_STORAGE"),options:e(Re,{setPage:o})}],[{name:s("APPS.SETTINGS.DATE_TIME"),options:[[{id:"twelveHourClock",name:s("APPS.SETTINGS.24_HOUR_TIME"),switch:!0,value:!r.time.twelveHourClock,onChange:()=>{var A,t,y,b,M;return d.Settings.patch({time:{...(t=(A=d.Settings)==null?void 0:A.value)==null?void 0:t.time,twelveHourClock:!((M=(b=(y=d.Settings)==null?void 0:y.value)==null?void 0:b.time)!=null&&M.twelveHourClock)}})}}],[{name:s("APPS.SETTINGS.SET_AUTOMATICALLY"),switch:!0,value:!0,disabled:!0},{name:s("APPS.SETTINGS.TIME_ZONE"),value:Intl.DateTimeFormat().resolvedOptions().timeZone??"Unknown"}]]},{name:s("APPS.SETTINGS.LANGUAGE_REGION"),options:[[{name:s("APPS.SETTINGS.LANGUAGE"),value:s("LABEL"),options:e(Q,{type:"Language",setPage:o})}],[{name:s("APPS.SETTINGS.TEMPERATURE"),value:r.weather&&r.weather.celcius?"C":"F",options:e(Q,{type:"Temperature",setPage:o})}]]}],[{name:s("APPS.SETTINGS.RESET_POPUP.TITLE"),onClick:()=>{f.PopUp.set({title:s("APPS.SETTINGS.RESET_POPUP.TITLE"),description:s("APPS.SETTINGS.RESET_POPUP.TEXT"),buttons:[{title:s("APPS.SETTINGS.RESET_POPUP.CANCEL")},{title:s("APPS.SETTINGS.RESET_POPUP.CONFIRM"),color:"red",cb:()=>I("Security",{action:"factoryReset"})}]})}}]]},{name:s("APPS.SETTINGS.DISPLAY_BRIGHTNESS"),description:s("APPS.SETTINGS.DISPLAY_BRIGHTNESS_DESCRIPTION"),icon:e(Ie,{className:"blue"}),options:e(be,{setPage:o})},{name:s("APPS.SETTINGS.WALLPAPER"),description:s("APPS.SETTINGS.WALLPAPER_DESCRIPTION"),icon:e(Ce,{className:"lightblue"}),options:e(Be,{setPage:o})},{name:s("APPS.SETTINGS.FACE_ID_PASSWORD"),description:s("APPS.SETTINGS.FACE_ID_PASSWORD_DESCRIPTION"),icon:e(fe,{className:"green"}),options:e(Me,{setPage:o})},{name:s("APPS.SETTINGS.BATTERY"),description:s("APPS.SETTINGS.BATTERY_DESCRIPTION"),icon:e(Ge,{className:"green"})}],[{name:s("APPS.SETTINGS.PHONE"),description:"Toggle caller id, block numbers etc.",icon:"./assets/img/icons/apps/Phone.jpg",color:"green",options:e(Fe,{setPage:o}),last:!0}]])},[r]);const H=()=>{let C=0;return r.apps.forEach(A=>{A.forEach(t=>{C++})}),C},X=S.useRef(!0),R=S.useRef(!1);return S.useEffect(()=>{if(X.current){X.current=!1;return}R!=null&&R.current||(R.current=!0)},[r]),S.useEffect(()=>()=>{R!=null&&R.current&&(I("setSettings",r),R.current=!1)},[n==null?void 0:n.active]),S.useEffect(()=>{if(l.length>0){let C=v.map(A=>A.filter(t=>{var y;return t.name.toLowerCase().includes(l.toLowerCase())?!0:t.options&&((y=t.options)!=null&&y.name)?t.options.filter(b=>{if(b.name.toLowerCase().includes(l.toLowerCase()))return!0;if(b.options)return b.options.filter(M=>{if(M.name.toLowerCase().includes(l.toLowerCase()))return!0})}):!1}));N(C)}else N([])},[l]),e($.Provider,{value:{settingsSections:v},children:e("div",{className:"settings-container",children:m.length===0?i(k.div,{...O("left","home"),className:"animation-container",children:[e("div",{className:"title default",style:((q=r==null?void 0:r.display)==null?void 0:q.theme)==="dark"?{color:"#ffffff"}:{color:"#000000"},children:s("APPS.SETTINGS.TITLE")}),e(ke,{placeholder:s("SEARCH"),onChange:C=>c(C.target.value)}),a.length>0?e("section",{children:a.map((C,A)=>e(S.Fragment,{children:C.map((t,y)=>i("div",{className:"settings-item","data-clickable":!!(t.options||t.onClick),onClick:()=>{if(t.onClick)return t.onClick();t.options&&(o(t.options),h(t.name))},children:[i("div",{className:"setting",children:[t.icon&&(typeof t.icon=="string"?e("img",{src:t.icon}):t.icon),i("div",{className:"setting-info",children:[e("div",{className:"title",children:t.name}),t.description&&e("div",{className:"description",children:t.description})]})]}),i("div",{className:"setting-value",children:[t.switch&&e(w,{onChange:t.onChange,checked:t.value,disabled:t.disabled??!1}),t.value&&!t.switch&&e("div",{className:"value",children:t.value}),t.options&&e(U,{className:"chevron"})]})]},y))},A))}):i(g,{children:[i("div",{className:"profile",onClick:()=>o(e(Ke,{setPage:o})),children:[r.avatar?e("div",{className:"avatar",style:{backgroundImage:`url(${r.avatar})`}}):e("div",{className:"avatar",children:Oe(r.name)}),i("div",{className:"profile-info",children:[e("div",{className:"name",children:r.name}),e("div",{className:"info",children:s("APPS.SETTINGS.CLOUD_BACKUP")})]}),e(U,{className:"chevron"})]}),v.map((C,A)=>e("section",{"data-last":A===v.length-1,children:C.map((t,y)=>i("div",{className:"settings-item","data-clickable":!!(t.options||t.onClick),onClick:()=>{if(t.onClick)return t.onClick();t.options&&(o(t.options),h(t.name))},children:[i("div",{className:"setting",children:[t.icon&&(typeof t.icon=="string"?e("img",{src:t.icon}):t.icon),i("div",{className:"setting-info",children:[e("div",{className:"title",children:t.name}),t.description&&e("div",{className:"description",children:t.description})]})]}),t.notification&&e("div",{className:"settings-notification",children:"1"}),i("div",{className:"setting-value",children:[t.switch&&e(w,{onChange:t.onChange,checked:t.value,disabled:t.disabled??!1}),t.value&&!t.switch&&e("div",{className:"value",children:t.value}),t.options&&e(U,{className:"chevron"})]})]},y))},A))]})]}):e(g,{children:m.length?i(k.div,{...O("right",m.length),className:"animation-container",children:[i("div",{className:"top",children:[i("div",{className:"back",onClick:()=>{o((E==null?void 0:E.page)??[]),h((E==null?void 0:E.name)??"Settings"),P(null),_(null)},children:[e(L,{}),u??s("APPS.SETTINGS.TITLE")]}),i("div",{className:"title",children:[T??s("APPS.SETTINGS.TITLE")," "]}),e("div",{})]}),m.map((C,A)=>e("section",{children:C.map((t,y)=>i("div",{className:"settings-item","data-clickable":!!(t.options||t.onClick),onClick:()=>{var b;if(t.onClick)return t.onClick();t.options&&(o(t.options),h(t.name),(b=t.options)!=null&&b[0]&&P({page:m,name:t.name}))},children:[e("div",{className:"setting",children:i("div",{className:"setting-info",children:[e("div",{className:"title",children:t.name}),t.description&&e("div",{className:"description",children:t.description})]})}),t.notification&&e("div",{className:"settings-notification",children:"1"}),e("div",{className:"setting-value",children:t.input?e(_e,{defaultValue:t.value,maxLength:t.input.maxLength,onChange:b=>{let M={...r,[t.input.type]:b.target.value};d.Settings.set(M)},onBlur:()=>{t.cb&&t.cb(r[t.input.type],r)}}):i(g,{children:[t.switch&&e(w,{checked:t.value,disabled:t.disabled??!1,onChange:()=>{t.onChange()}}),t.value&&e("div",{className:"value",children:t.isLink?e("a",{onClick:()=>window.invokeNative("openUrl",t.value),children:t.value}):t.value}),t.options&&e(U,{className:"chevron"})]})})]},y))},A))]}):m})})})}export{$ as AppContext,ze as default};
